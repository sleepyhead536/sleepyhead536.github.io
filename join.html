<!DOCTYPE html>
<html>
    <head>
        <link href="css/default.css" rel="stylesheet">
    </head>
    <body>
        <h1>
            Join Setup
        </h1>
    </body>

    <h2 id="player-name">
        Name
        <input type="text" name="name" id="name">
    </h2>

    <h2 id="host-ip">
        Host IP address
        <input type="text" name="host-ip" id="host-ip">
    </h2>

    <button onclick="join()">
        Join
    </button>

    <body id="main">
        <h1 id="playersTitle">
            Players:
        </h1>
        <p id="players"></p>
    </body>

    <script src="js/GameManager.js"></script>
    <script src="js/Server.js"></script>
    <script>
        gameManager = new GameManager();

        function addPlayer() {
            var player = new Player();
            gameManager.players[player.id] = player

            var playerNameField = document.createElement("input");
            playerNameField.type = "text";
            playerNameField.id = "playerNameField" + player.id
            playerNameField.player_id = player.id
            document.getElementById("players").appendChild(playerNameField);
            document.getElementById("players").append(document.createElement("br"));
            document.getElementById(playerNameField.id).addEventListener("input", function () {
                player.nameTextFieldCallback() 
            }, false);
        }

        function createGame() {
            document.getElementById("players").remove();
            document.getElementById("playersTitle").remove();
            gameManager.dealPlayers();
            createDiscardSection();
            createPlayersSection();
        }

        function createDiscardSection() {
            var discardSection = document.createElement("h1");
            var discardSectionTitle = document.createTextNode("Discarded Roles");
            discardSection.appendChild(discardSectionTitle);
            discardSection.id = ("discard");
            document.getElementById("main").appendChild(discardSection);
        }

        function createPlayersSection() {
            var playersSection = document.createElement("h1");
            var playersSectionTitle = document.createTextNode("Players");
            playersSection.appendChild(playersSectionTitle);
            playersSection.id = ("players");
            document.getElementById("main").appendChild(playersSection);
            for (var id in gameManager.players) {
                createPlayerSection(id);
            }
        }

        function createPlayerSection(playerId) {
            var playerSection = document.createElement("h2");
            var playerTitle = document.createTextNode(gameManager.players[playerId].getName())
            var playerCards = document.createTextNode("Cards: " + gameManager.players[playerId].getCards().length)
            var playerCoins = document.createTextNode("Coins:" + gameManager.players[playerId].getCoins())
            playerSection.appendChild(playerTitle);
            playerSection.appendChild(document.createElement("br"));
            playerSection.appendChild(playerCards);
            playerSection.appendChild(document.createElement("br"));
            playerSection.appendChild(playerCoins);
            document.getElementById("main").appendChild(playerSection);
        }

    </script>
</html>